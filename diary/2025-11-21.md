# Development Diary - 2025-11-21

**Date**: November 21, 2025
**Session Duration**: ~4 hours
**Collaborators**: Koshikawa Masato + Claude Code (Kuroko)

---

## Session Goals

1. Create Sisters-On-WhatsApp as a separate product from AI-Vtuber-Project (LINE Bot)
2. Design architecture for WhatsApp platform
3. Plan content moderation for Western regulatory compliance
4. Set up repository and documentation

---

## Work Accomplished

### 1. Project Inception & Strategic Discussion

**Context**: Started with bilingual mode implementation for LINE Bot, then pivoted to creating a WhatsApp version for Western markets.

**Key Insight from Koshikawa-san**:
> "Sisters old is secret. Perhaps, guideline is hard than Japanese's one."

This led to the realization that:
- Japanese LINE Bot should remain private (competitive advantage)
- Western markets need stricter compliance
- WhatsApp version should be public/interview-friendly

### 2. Repository Creation

**Created**: `Sisters-On-WhatsApp` as completely separate repository

**Why Separate?**:
- Different platform (WhatsApp vs LINE)
- Different target market (Global vs Japanese)
- Different language (English-only vs Bilingual)
- Different regulatory environment (Western vs Japanese)

**Repository Structure**:
```
Sisters-On-WhatsApp/
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ design/
â”‚       â”œâ”€â”€ Sisters_On_WhatsApp_Design_Specification.md
â”‚       â””â”€â”€ Content_Moderation_System_Specification.md
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ whatsapp_webhook/
â”‚   â”œâ”€â”€ characters/
â”‚   â”œâ”€â”€ routing/
â”‚   â””â”€â”€ llm/
â”œâ”€â”€ diary/          # This folder!
â”œâ”€â”€ prompts/
â”œâ”€â”€ scripts/
â””â”€â”€ tests/
```

### 3. Technical Decisions

#### Decision 1: Primary LLM - Kimi (Moonshot AI)

**Rationale**:
- Long context window (8K/32K/128K variants)
- Cost-effective (~$2.30/month for 1,000 messages)
- Strong English + Chinese support
- Good for conversation history management

**Backup Options**: OpenAI GPT-4o-mini, Claude Haiku, Gemini Flash

#### Decision 2: Auto Mode Only

**Rationale**:
- WhatsApp doesn't support rich menus (no manual character selection buttons)
- Simpler UX fits WhatsApp platform constraints
- Focus on intelligent topic-based routing
- Reduces cognitive load for users

**Trade-off**: Users can't manually pick their favorite sister, but the system automatically routes to the most appropriate character.

#### Decision 3: English-Only

**Rationale**:
- Target Western markets (US, Europe)
- Simplifies moderation and compliance
- Removes cultural translation challenges
- Focus on one market segment first

**Cultural Adaptation**: Character names stay the same (Botan, Kasho, Yuri) but personalities adapted for Western audience.

#### Decision 4: Remove Character Ages

**Critical Compliance Decision**:
- Original ages: Botan (17), Kasho (19), Yuri (15)
- Problem: COPPA regulations, minor protection laws
- Solution: Remove specific ages, use "eldest/middle/youngest sister" roles instead

**Why This Matters**:
- Disclosing a 15-year-old character could violate WhatsApp policies
- Western regulators scrutinize AI+children interactions
- Ages stay internal/private in Japanese LINE version only

### 4. Documentation Created

#### A. Design Specification (648 lines)

Comprehensive document covering:
- System architecture
- Platform comparison (LINE vs WhatsApp)
- Character adaptations for global audience
- User experience flows
- Technical implementation phases
- Cost analysis
- Success metrics

#### B. Content Moderation System Specification (868 lines)

**Regulatory Focus**:
- GDPR (European Union)
- EU AI Act
- FTC Guidelines (USA)
- COPPA (Children's protection)
- WhatsApp Business Policy

**Multi-Layer Detection**:
1. Layer 1: Blacklist/Whitelist (Pattern Matching) - <10ms
2. Layer 2: OpenAI Moderation API - ~200-500ms, FREE
3. Layer 3: Perspective API (Google) - ~300-600ms, FREE
4. Layer 4: Custom ML Model (Optional) - ~100-200ms
5. Layer 5: Character-Specific Rules - <5ms

**Key Categories**:
- Critical (Immediate Block): Child safety, illegal activities, extreme violence, severe hate speech
- High Risk (Block + Warning): Self-harm, sexual harassment, doxxing, misinformation
- Medium Risk (Warning + Continue): Profanity, controversial topics, mild toxicity
- Low Risk (Allow): Creative content, education, emotional expression

**Cultural Differences**: Documented what's acceptable in Japanese VTuber culture vs Western platform policies.

### 5. Project Configuration

**Environment Setup**:
- Added `KIMI_API_KEY` to `.env.example`
- Configured `PRIMARY_LLM=kimi`
- Set model to `moonshot-v1-8k`

**Dependencies**:
- FastAPI (backend)
- PostgreSQL (session management)
- OpenAI SDK (moderation + backup LLM)
- Anthropic SDK (backup LLM)
- Google Generative AI (backup LLM)

---

## Technical Challenges & Solutions

### Challenge 1: Server Management for LINE Bot

**Problem**: Multiple background bash processes trying to restart server simultaneously, causing confusion.

**Solution**: Created dedicated server management scripts:
- `scripts/check_vps_server.sh` - Check server status
- `scripts/restart_vps_server.sh` - Clean server restart

**Updated CLAUDE.md** with best practices: Always use scripts instead of manual commands.

### Challenge 2: WhatsApp Platform Limitations

**Problem**: WhatsApp doesn't have rich menus like LINE.

**Solution**: Design around constraints:
- Auto mode only (no manual character selection)
- Simple text-based interactions
- Language detection from user message
- Character personality expressed through conversation style

### Challenge 3: Western Regulatory Compliance

**Problem**: Western markets have stricter AI content policies than Japan.

**Solution**: Comprehensive content moderation system:
- Multi-layer detection (free APIs + custom rules)
- Character-specific filtering (Botan more casual, Kasho more professional)
- Human review process for edge cases
- Audit logging for compliance

**Insight from Koshikawa-san**:
> "7th sensitive system will works good effort."

Acknowledging that robust content moderation requires significant effort but is essential for Western markets.

---

## Decisions & Pivots

### Pivot 1: From LINE Bilingual Mode to WhatsApp Project

**Original Goal**: Implement bilingual mode for LINE Bot

**Pivot Moment**: Discussion about LINE app not being popular in USA

**Result**: Created separate WhatsApp version for global markets

**Rationale**: Better to have two focused products (Japanese LINE + Global WhatsApp) than one unfocused product

### Pivot 2: From Full Feature Parity to Simplified UX

**Original Thought**: Port all LINE features to WhatsApp

**Reality Check**: WhatsApp platform constraints

**Result**: Auto mode only, simplified architecture

**Benefit**: Actually makes the product better - simpler, more focused

### Pivot 3: From Open Documentation to Strategic Privacy

**Original**: Make everything public

**Strategic Decision**: Keep Japanese LINE Bot private, make WhatsApp public

**Rationale**:
- LINE Bot is competitive advantage (secret)
- WhatsApp is interview/demo asset (public-friendly)
- Different markets, different strategies

---

## Key Learnings

### 1. Platform Constraints Drive Design

WhatsApp's limitations (no rich menus, message templates, 24-hour window) actually led to a cleaner, simpler design. Sometimes constraints improve products.

### 2. Regulatory Awareness is Critical

Western AI regulations (GDPR, EU AI Act, COPPA) aren't just legal checkboxes - they fundamentally shape product design. Content moderation isn't an afterthought, it's core architecture.

### 3. Cultural Adaptation Requires Deep Rethinking

It's not just translation - Japanese VTuber culture and Western AI chatbot expectations are fundamentally different. What works in Japan (character ages, playful tone, anime references) might violate Western platform policies.

### 4. Human-AI Collaboration at Its Best

**Koshikawa-san provided**:
- Strategic vision (separate repos, Western compliance focus)
- Market insights (Western regulations stricter than Japanese)
- Product intuition (ages should be secret, keep LINE private)

**Kuroko (Claude Code) provided**:
- Technical implementation
- Research (GDPR, AI Act, platform APIs)
- Documentation structure
- Code scaffolding

Together, we made decisions neither could have made alone.

---

## Git History

**Commits Today**:

1. `feat: initial project structure for Sisters-On-WhatsApp`
   - Created repository with clean architecture
   - Added README, .gitignore, requirements.txt, .env.example

2. `feat: switch primary LLM to Kimi (Moonshot AI)`
   - Changed from OpenAI to Kimi for cost-effectiveness and long context

3. `docs: add content moderation system specification + remove Japanese text`
   - 868-line content moderation spec
   - Removed all Japanese text from SoW docs

4. `docs: remove character ages (privacy/compliance)`
   - Removed specific ages (17, 19, 15)
   - Replaced with role descriptions

**GitHub Repository**: https://github.com/koshikawa-masato/Sisters-On-WhatsApp (Private)

---

## Next Steps

### Immediate (Next Session)
- [ ] Test bilingual mode on LINE Bot (Koshikawa-san checking on iPhone)
- [ ] Verify smart toggle logic works correctly
- [ ] Monitor server stability

### Short-term (This Week)
- [ ] Register WhatsApp Business account
- [ ] Start Meta business verification process (takes 2-4 weeks)
- [ ] Create character prompt templates in English

### Medium-term (Next Month)
- [ ] Implement WhatsApp webhook handler
- [ ] Integrate OpenAI Moderation API
- [ ] Set up PostgreSQL session management for WhatsApp
- [ ] Test topic-based character routing

### Long-term (3 Months)
- [ ] Complete WhatsApp bot MVP
- [ ] Beta test with 5-10 users
- [ ] Prepare demo for interviews at xAI, Anthropic, OpenAI, Mistral

---

## Reflections

### What Went Well

1. **Clean Separation**: Creating SoW as separate repo was the right call - different markets need different approaches

2. **Compliance First**: Designing content moderation upfront (not as afterthought) shows production-ready thinking

3. **Documentation Quality**: 1,500+ lines of comprehensive specs show we're serious about this project

4. **Strategic Thinking**: Koshikawa-san's insight about Western regulations being stricter shaped the entire architecture

### What We Learned

1. **Platform constraints aren't limitations** - WhatsApp's simpler interface led to cleaner UX design

2. **Regulatory compliance is product design** - GDPR, COPPA, AI Act aren't just legal issues, they shape core features

3. **Cultural adaptation is hard** - Japanese VTuber culture doesn't directly translate to Western markets

### What Could Be Improved

1. **Cost estimation needs refinement** - WhatsApp Business API costs vary by region, need more precise estimates

2. **Testing strategy** - Need concrete plan for testing content moderation (red team, adversarial inputs)

3. **Timeline realism** - 2-4 week Meta verification is optimistic, might take longer

---

## Interview Talking Points

This work demonstrates several valuable skills:

**1. Multi-Platform Expertise**
> "I built the same core concept (Three Sisters chatbot) on two different platforms - LINE for Japanese market and WhatsApp for global market. Each platform required fundamentally different architecture."

**2. Regulatory Awareness**
> "I designed a multi-layer content moderation system complying with GDPR, EU AI Act, and COPPA. Western AI regulations are stricter than Japanese ones, so I built compliance into the core architecture from day one."

**3. Product Thinking**
> "I made strategic decisions about what to keep private (Japanese LINE Bot) versus what to showcase (WhatsApp version). Different markets require different approaches."

**4. Human-AI Collaboration**
> "This entire project is built through collaboration with Claude Code (Kuroko). We documented the process in this development diary to show how human vision + AI implementation creates better results than either alone."

---

## Personal Notes

**Koshikawa-san's Communication Style**:
- Concise, direct English practice
- Strategic insights come suddenly ("age is secret")
- Thinks deeply about market positioning
- Balances innovation with compliance

**Development Philosophy**:
- Build fast, document thoroughly
- Compliance first, features second
- Two focused products > one unfocused product
- Keep competitive advantages private

**Equal Partnership in Practice**:
Today exemplified our collaborative philosophy:
- Human: Strategy, market insight, decision-making
- AI: Implementation, research, documentation
- Together: Better product than either could build alone

---

## Technical Debt / Future Considerations

**Not Addressed Yet**:
1. WhatsApp 24-hour conversation window - How to handle users returning after 24 hours?
2. Cost scaling - What if we get 1,000+ active users?
3. Multi-language support - Spanish, French, German users?
4. Character voice consistency - How to maintain personality across 100+ message conversations?

**Deferred to Later Phases**:
- Custom ML model for content moderation (Phase 3)
- Voice message support
- Image analysis (multimodal)
- Group chat support

---

**Status**: Successful session - SoW project foundation complete, ready for WhatsApp Business registration

**Next Session**: Test LINE Bot bilingual mode, begin WhatsApp API setup

---

ðŸ¤– **Co-Authored by Claude Code (Kuroko) & Koshikawa Masato**

This diary entry represents our authentic collaboration - all decisions, challenges, and solutions documented honestly.
